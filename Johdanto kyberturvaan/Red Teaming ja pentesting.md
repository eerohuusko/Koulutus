Kybertiedustelu - Red Teaming ja pentesting
===


Kybertiedustelu (recon / reconnaissance) ja Red Teaming voidaan tehdä erillisinä projekteina, mutta ne toimivat hyvin myös yhdistetyinä. 

Yrityksen näkökulmasta voi olla hyvä ajatus tehdä ensin perusteellinen kybertiedustelu jotta ymmärrettäisiin kattavasti mahdollisten rikollisten toimijoiden näkemyksiä organisaatiosta – eikä vain teknisessä mielessä.

Kybertiedustelu voi tarjota hyvää tietoa ja päivityksiä riskirekisteriin ja syvälliseen uhkamallinnukseen valmistautumiseen.

Vaikka tiedusteluvaihe voi tuntua – ihan oikeutetusti – hiukan teoreettiselta, Red Teaming -harjoituksessa tiedustelun tulokset ja Red Teaming -ryhmän taidot laitetaan testiin. 

Testissä yritysten puolustukset kaadetaan – lukuunottamatta sellaisia kohteita, jotka yritys on erityisesti rajannut ulos. Muutoin rajoituksia ei ole.


# Mitä kybertiedustelulla tarkoitetaan

Kybertiedustelu on se, mitä tehdään, kun halutaan saada mahdollisimman paljon tietoa mahdollisesta vihollisesta – alkuperäinen termi recon:han on loppujen lopuksi sotilaallinen termi. 

Vihollinen, tai tässä tapauksessa kohde, on asiakas.

Kaikki testissä tehtävä tiedustelu on sekä eettistä että laillista. testissä ei saa käyttää mitään tekniikoita, joista voisi seurata rikosvastuuta tai -seuraamuksia kenellekään osapuolelle. 

Kybertiedustelun aikana muodostetaan kuva kyberympäristöstä, näkemyksen, kuinka vihollisesi näkevät yrityksen tai tarkastelun kohteen. 

Kybertiedustelu antaa tietenkin myös käsityksen siitä, kuinka altis yritys/kohde voi olla satunnaisille hyökkäyksille sekä mahdollisille ”paskaa tuuria” -tyyppisille skenaarioille.

Tärkein syy tiedustelun tekemiseen on yksinkertaisesti selvittää yrityksen tietoturvan taso. 

Vastustaja tietää yleensä heikkoudet, joihin tyyppillisesti hyökkäys ainakin alkuvaiheessa kohdentuu. 

Tiedustelussa käytetään useita erilaisia erilaisia tekniikoita uhkien ja riskien arvioimiseksi. Jotkut niistä ovat vakiomentelmiä – toiset voivat olla yritys- tai domain-kohtaisia.


# Kybertiedustelumenetelmät

Seuravassa on lueteltu muutamia esimerkkejä, joita kybertiedustelutoimeksianto voi sisältää:

* Tarkastelemalla yrityksen verkkosivuilta organisaatiotietoja ja henkilöstöä.
* Hakukoneen (Google ym.) avulla parannetaan edelleen ymmärrystä organisaatiosta ja sen asseteista – mukaan lukien ei-julkinen tieto.
* Katsotaan työpaikkailmoituksista tietoa teknologioista ja infrastruktuurista.
* Työntekijöiden vuotaneiden valtuuksien etsiminen.
* Selvitetään yrityksen menneisyydestä tietoja, jotka se saattaa haluta unohtaa – the Wayback machine
* Käytetään Shodania etsimään helppoja kohteita olemassa olevista asseteista.
* Whois-tietojen tutkiminen.
* Perehdytään sertifikaatteihin (certificate transparency logs)
* Kaivellaan tallennuspalvelimien – ”bucketien” – sisältöjä.
 
# Red Teamingin
Tunkeutumistesti (pentest/penetration test) on rajoitettu sekä (kalenteri)ajan että laajuuden suhteen. 

Testi on hyvä menetelmä selvittää heikkoudet jostain tietystä tärkeästä kohteesta – web-sovelluksesta, palvelimesta tai pilvipalvelusta. 

**Red Tea**m keskittyy puolestaan laajempaan kuvaan tietoturvasta. 

Red Teaming ei välitä missä sovelluksessa, missä palvelussa, missä kokoonpanossa – tai ovessa – haavoittuvuus on. Kun haavoittuvuus on löydetty, keskitytään sen hyväksikäyttöön. 

Tämän ansiosta Red Teaming antaa realistisia ja todellisia tuloksia siitä, kuinka vastustajat ajattelevat ja toimivat. 

Red Teamingiin tarvittavat resurssit ovat hyvin erilaisia, kuin pentestaukseen tarvittavat. 



# Red Teaming -taktiikka ja -työkalut.

* Phishing / tiedon kalastelu
* Sosiaalinen manipulointi
* USB-tartuttaminen
* Hakkerointi
* Skannaus
* Ovien avaaminen (ja sulkeminen)
* Odotetaan – toistetaan – ja odotetaan vielä lisää

# Pentesting web-sovelluksiin

Yleinen web-sovelluksen tietoturvan arviointiin käytetty työkalu on tunkeutumistestaus. 

Rakkaalla lapsella on monta nimeä, ja tunkeutumistestaus tunnetaan myös nimellä pentest eli englanniksi penetration testing. 

Kyseessä on luvallinen simuloitu hyökkäys, jolla pyritään käyttämään sovellusta siten, että se voi olla vahingollista joko järjestelmälle, järjestelmässä olevalle tiedolle tai järjestelmää käyttäville henkilöille.

# Testin tavoiteet

Testin tarkoituksena on pyrkiä simuloimaan pahantahtoisen hyökkääjän aikeita ja todentaa sovelluksen toiminta poikkeuksellisessa tilanteessa. 

Tavoitteeksi asetetaan useimmiten yleisimpien virheiden löytäminen sovelluksesta. 

Tämä on erittäin hyvä lähestymistapa varsinkin silloin, jos sovellusta tai järjestelmää ollaan ensimmäistä kertaa testaamassa.

Testauksen kriteeristönä käytetään tunnettuja ja yleisesti hyväksyttyjä, erityisesti web-sovellusten tietoturvan arviointiin luotuja standardeja ja tarkistuslistoja, joista käytetyin on OWASP top-10. 

OWASP top-10 kattaa yleisimmät web-sovelluksissa esiintyvät virheet ja tätä tarkistuslistaa ylläpidetään ja tarkistetaan säännöllisesti. 

Siksi voidaankin aina oletusarvoisesti luottaa siihen, että noudattamalla OWASP top-10 ensisijaisena testauskriteerinä, ollaan testaamassa oikeita asioita.


# Skannaus tukee testausta

Verkko- ja palvelinskannauksella luodaan sovelluksen elinympäristöstä tilannekuva ja varmistetaan, että sovelluksen taustainfrastruktuurissa ei ole sellaisia aukkoja, joita hyödyntämällä mahdollinen hyökkääjä voisi ohittaa käytetyt suojaukset. 

Samalla löydetään mahdollisia kohteita varsinaiseen tunkeutumistestaukseen. 

Skannaus voidaan ympäristöstä riippuen tehdä sekä sisäisen että ulkoisen hyökkääjän näkökulmasta.

# Kohteet

Sovelluksilla on useimmiten sekä asiakasrajapinta – sovelluksen normaali käyttöliittymä – ja lisäksi jonkinlainen sisäinen käyttöliittymää. 

Jälkimmäistä käytetään yleensä yrityksen toimihenkilöiden toimesta. 

Tämän lisäksi on usein hyvä tunnistaa erilaiset API-rajapinnat joiden testaaminen voi olla perusteltua myös muutoin kuin sovelluksia käyttämällä.

Testaus suoritetaan suurimmalla mahdollisella varovaisuudella, noudattaen periaatetta, jossa tietoisesti vältetään esim. tuhoisien tietokantasyötteiden käyttämistä testauksen aikana. 

Syötteet voivat testauksen aikana olla virheellisiä ja rikkinäisiä, mutta esim. tietokantoihin kirjoittavia tai tietokantoja tuhoavia (DROP) testisyötteitä ei käytetä. 

Tämä mahdollistaa sen, että testaus suoritetaan täysin tilanteesta riippuen joko tuotantoympäristössä tai testiympäristössä.

![](https://gitlab.dclabra.fi/wiki/uploads/upload_2fc847068162fddd49862fac55402346.png)

Lähde: OWASP Top-10

Tunkeutumistestaus eli pentestaus on tietoturvan perustyökalu. Testaus kannattaa suorittaa siten, että kehitystiimit ovat mukana ja saavat raportin lisäksi mahdollisuuden kysyä suoraan auditoijalta tarkennuksia ja vihjeitä ongelmien korjaamiseksi.